#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir> <env-dir>

set -euo pipefail

BUILD_DIR=$1
PATH_DIR="/app"
INSTALL_DIR="$PATH_DIR/.awscli"

cd $BUILD_DIR

echo "-----> Installing AWS CLI"

cp aws/.awscli $PATH_DIR/.awscli

ln -s $PATH_DIR/.awscli/v2/2.14.5/bin/aws $BUILD_DIR/custom-bin/aws

echo "-----> Exporting PATH"

echo "export PATH=$PATH:$HOME/custom-bin" >> $PATH_DIR/.profile.d/aws_binaries.sh

echo "-----> Successfully installed AWS CLI"
